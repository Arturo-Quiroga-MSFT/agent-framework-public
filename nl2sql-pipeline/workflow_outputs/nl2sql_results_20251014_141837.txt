================================================================================
🔍 NL2SQL PIPELINE RESULTS
================================================================================

────────────────────────────────────────────────────────────────────────────────
🤖 Step 1: system
────────────────────────────────────────────────────────────────────────────────

QUERY RESULTS:

⏱️  Execution Time: 1085.39ms
📊 Rows Returned: 3

│ Customer_Segment   │ Total_Loans   │ Total_Original_Amount   │ Avg_Original_Amount   │ Avg_Loan_Term_Months   │ Total_Current_Balance   │ Avg_Annual_Revenue   │ Distinct_Customers   │
├────────────────────┼───────────────┼─────────────────────────┼───────────────────────┼────────────────────────┼─────────────────────────┼──────────────────────┼──────────────────────┤
│ Large Corporate    │ 157           │ 4284085048.00           │ 27287165.910828       │ 62                     │ 3458448936.32           │ 198911169.095541     │ 88                   │
│ Middle Market      │ 500           │ 1338466506.00           │ 2676933.012000        │ 58                     │ 1068474623.39           │ 27471327.378000      │ 281                  │
│ Small Business     │ 871           │ 234174492.00            │ 268857.051664         │ 58                     │ 186849750.11            │ 3032377.304247       │ 470                  │
└────────────────────┴───────────────┴─────────────────────────┴───────────────────────┴────────────────────────┴─────────────────────────┴──────────────────────┴──────────────────────┘

Please interpret these results and provide a natural language answer to the user's question.

────────────────────────────────────────────────────────────────────────────────
🤖 Step 2: results_interpreter
────────────────────────────────────────────────────────────────────────────────

**Answer:** Large Corporate customers have the fewest loans but the largest average loan size and annual revenue, while Small Business customers have the most loans but the smallest average loan size and revenue.

**Insights:**
- Large Corporate segment: 157 loans with an average original amount of $27.3M per loan and average annual revenue of ~$198.9M; 88 distinct customers.
- Middle Market segment: 500 loans, average loan size of ~$2.7M, and average annual revenue of ~$27.5M; 281 distinct customers.
- Small Business segment: 871 loans, average loan size of ~$269K, and average annual revenue of ~$3M; 470 distinct customers.
- Despite fewer loans, Large Corporates account for the majority of total original loan amounts and current balances due to much larger average loan sizes.
- Loan terms are similar across segments (58-62 months).

**Suggestions:**
- What is the loan approval rate or default rate by segment?
- How do these segments trend over time in terms of loan growth or average loan size?

================================================================================
✅ NL2SQL Pipeline Complete
================================================================================